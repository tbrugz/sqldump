<project name="sqldump">
	
	<property name="src.dir" value="src"/>
	<property name="src.graphml.dir" value="src_graphml"/>
	<property name="bin.dir"  value="bin"/>
	<property name="dist.dir" value="dist"/>
	<property name="javadoc.dir" value="dist/javadoc"/>
	<property name="sqldump.main.class" value="tbrugz.sqldump.SQLDump"/>
	
	<property file="build.properties"/>

	<path id="classpath.compile">
		<pathelement location="lib/commons-logging-1.1.1.jar"/>
		<pathelement location="lib/log4j-1.2.15.jar"/>
		<pathelement location="lib/kmlutils.jar"/>
	</path>
	
	<path id="classpath.run">
		<path refid="classpath.compile"/>
		<pathelement location="${bin.dir}"/>
		<pathelement location="${run.xtralib}"/>
	</path>

	<target name="prepare">
		<mkdir dir="${bin.dir}"/>
		<mkdir dir="${dist.dir}"/>
		<mkdir dir="${javadoc.dir}"/>
		<!--if>
			<available file="sqldump.properties"/>
			<then></then>
			<else>
				<copy file="sqldump.properties.template" tofile="sqldump.properties" verbose="on"/>
			</else>
		</if-->
	</target>

	<target name="compile" depends="prepare">
		<javac destdir="${bin.dir}" classpathref="classpath.compile" debug="on">
			<src path="${src.dir}"/>
			<src path="${src.graphml.dir}"/>
		</javac>
		<copy todir="${bin.dir}" >
			<fileset dir="${src.dir}">
				<include name="**/*.properties"/>
			</fileset>
		</copy>
	</target>

	<target name="run">
		<java classpathref="classpath.run" classname="${sqldump.main.class}">
			<arg value="${run.arg}"/>
		</java>
	</target>
	
	<target name="test">
		<java classpathref="classpath.run" classname="${sqldump.main.class}">
			<arg value="-propfile=test/sqldump-jaxb-test.properties"/>
		</java>
	</target>
	
	<target name="jar" depends="prepare">
		<jar destfile="${dist.dir}/sqldump.jar"
			basedir="${bin.dir}"
			includes="**/*.class, *.properties, **/jaxb.index">
			<manifest>
				<attribute name="Main-Class" value="${sqldump.main.class}"/>
			</manifest>
		</jar>
	</target>

	<target name="javadoc" depends="prepare">
		<javadoc destdir="${javadoc.dir}" sourcepath="${src.dir}" />
	</target>
	
	<target name="all" depends="javadoc, jar">
		<!--copy todir="${dist.dir}/" verbose="on" file="sqldump.properties"/-->
	</target>
	
</project>